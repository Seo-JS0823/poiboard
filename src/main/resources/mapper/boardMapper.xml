<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.poiboard.mapper.BoardMapper">
	
	<!-- select All : parameter (MenuDTO > String menuid) -->
	<select id="getBoardList" resultType="com.poiboard.domain.BoardDTO">
		SELECT
			B.idx ,
			M.menuname ,
			B.title ,
			B.writer ,
			B.regdate ,
			B.hit
		FROM
			board B, menus M
		WHERE
			B.menuid = M.menuid AND
			B.menuid = #{menuid}
	</select>
	
	<!-- select All : parameter (BoardDTO > String title) -->
	<select id="searchTitle" resultType="com.poiboard.domain.BoardDTO" parameterType="java.lang.String">
		SELECT
			idx ,
			title ,
			writer ,
			regdate ,
			hit
		FROM
			board
		WHERE
			title Like CONCAT('%',#{search},'%')
	</select>
	
	<!-- select All : 페이징 기법으로 게시글 목록 가져오기 -->
	<select id="count" resultType="com.poiboard.domain.BoardDTO">
		SELECT
			idx, title, writer, regdate, hit
		FROM
			board
		WHERE
			menuid = #{menuid}
		LIMIT
			#{start}, #{recodeSize}
	</select>
	
	
	<!-- select 1 : idx에 해당하는 content 까지 검색 -->
	<select id="getIdxContent" resultType="com.poiboard.domain.BoardDTO" parameterType="int">
		SELECT
			idx, title, content, writer, regdate, hit
		FROM
			board
		WHERE
			idx = #{idx}
	</select>
	
	<!-- select 1 : 나누기 10한 페이징 수 가져오기 -->
	<select id="pagingsCount" resultType="int">
		SELECT
			CEIL((COUNT(*)/10)) AS pagings
		FROM
			board
		WHERE
			menuid = #{menuid}
	</select>
	
	<!-- insert 게시글 한 건 추가 -->
	<insert id="insertBoard">
		INSERT INTO board
			(menuid, title, content, writer)
		VALUES
			(#{menuid}, #{title}, #{content}, #{writer})
	</insert>

	<!-- update 게시글 클릭하면 조회수 1증가 올라가기 -->
	<update id="hitUp">
		UPDATE
			board
		SET
			hit = #{hit}
		WHERE
			idx = #{idx}
	</update>

	<!--  -->
	
	
</mapper>